import React from 'react';
import { GoogleMap, useLoadScript, MarkerF } from '@react-google-maps/api';
import { MapAustAndNz } from '../../assets';
import PulseLoader from 'react-spinners/PulseLoader';

export const Map = (props) => {

    const googleMapsApiKey = import.meta.env.VITE_GOOGLE_API_KEY;

	const { isLoaded, loadError } = useLoadScript({googleMapsApiKey});

	if (loadError) {
		return <MapAustAndNz />;
	}

	if (!isLoaded) {
		return (
			<div>
				<PulseLoader color={'#FFF'} />
			</div>
		);
	}

    const center = { lat: parseFloat(props?.lat), lng: parseFloat(props?.lon) }

	const customMarker = {
		path: 'M 0,0 V 256.00195 512.00391 L 256.25,511.75195 512.5,511.5 512.75195,255.75 513.00391,0 H 256.50195 Z M 148.66797,187 H 165 v 17 17 h -17 -17 v -16.33203 l 0.0918,-17.33985 c 0,0 8.59218,-0.32812 17.57617,-0.32812 z M 256,187 v 16.88086 16.88086 l -9.39648,0.41016 -9.39649,0.41015 -1.6543,1.37305 -1.65429,1.37304 0.30078,2.53711 0.30078,2.53711 3.19531,1.85938 c 1.758,1.023 9.48107,3.61658 17.16407,5.76758 24.00097,6.71699 34.3418,11.71507 41.46679,20.03906 l 3.71875,4.34375 1.47852,4.97656 c 3.35099,11.28699 0.52233,25.10436 -7.22266,35.27735 C 286.50979,311.89901 266.4727,319 245.38672,319 h -9.4375 l 0.27539,-16.25 0.27539,-16.25 9.10547,-0.50781 9.10547,-0.50586 1.64453,-1.36719 L 258,282.75586 258.87891,279.40039 258,276.04688 255.75,274.625 c -1.238,-0.781 -8.51398,-3.10316 -16.16797,-5.16016 -7.65399,-2.05699 -16.61506,-4.83869 -19.91406,-6.17968 -13.30499,-5.406 -21.99216,-13.1872 -25.66016,-22.99219 L 192,234.92578 v -6.78516 -6.78515 l 1.64844,-4.83594 c 5.94799,-17.45798 18.01258,-26.5298 37.85156,-28.4668 4.4,-0.429 11.713,-0.84101 16.25,-0.91601 z m 25.66797,0 H 298 v 17 17 h -17 -17 v -16.33203 c 0,-8.98399 0.30097,-16.634 0.66797,-17 0.366,-0.367 8.01601,-0.66797 17,-0.66797 z m -157.75781,0.33984 c 0,0 0.076,13.97603 0.084,24.79102 l 0.006,8.63281 -4.25,1.07617 c -9.48499,2.402 -17.16591,9.48483 -20.878906,19.25782 l -1.982422,5.21679 v 7.27735 7.27929 l 2.191406,5.09375 2.191402,5.09375 4.96094,4.46094 4.96094,4.45899 6.50781,2.01171 L 124.2111,284 h 7.80664 c 8.36299,0 19.75538,-1.87869 26.85937,-4.42969 2.406,-0.864 4.769,-1.57031 5.25,-1.57031 H 165 v 17.52539 17.52539 l -2.75,1.0586 c -1.512,0.58299 -6.8,1.97765 -11.75,3.09765 l -9,2.03711 -12,0.002 -12,0.004 -7.5,-1.70898 c -4.125,-0.94 -11.710427,-3.72923 -16.857422,-6.19922 l -9.359375,-4.49219 -7.695312,-7.67383 -7.695313,-7.67578 -3.724609,-7.19922 c -2.047998,-3.95899 -4.610314,-10.67016 -5.695313,-14.91016 L 57,261.67969 57.01758,254.08984 C 57.042578,243.40485 59.292099,233.87199 64.121094,224 L 68.28125,215.5 76.890625,207 85.5,198.5 93,194.85352 c 8.61699,-4.189 14.02901,-5.84038 22.5,-6.85938 3.3,-0.397 8.41016,-0.6543 8.41016,-0.6543 z M 383,187.69922 l 15.25,0.59766 15.25,0.5957 5.91992,1.58594 c 3.255,0.87099 8.60844,3.01943 11.89844,4.77343 l 5.98242,3.1875 3.76172,4.75977 c 2.069,2.618 4.57541,7.13225 5.56641,10.03125 l 1.80078,5.26953 0.0137,8.5 0.0137,8.5 -2.58984,5.56641 c -3.463,7.44399 -8.77671,12.3733 -18.09571,16.77929 l -7.72851,3.6543 0.46094,1.28516 c 0.254,0.707 7.89352,13.4304 16.97851,28.27539 C 446.56741,305.90553 454,318.26439 454,318.52539 454,318.78539 443.97278,319 431.7168,319 H 409.43555 L 396.2168,296.11328 383,273.22852 V 256.61328 240 h 8.13477 c 9.74899,0 15.32459,-1.49646 17.93359,-4.81445 L 411,232.73047 v -3.93164 c 0,-5.391 -1.44608,-7.64433 -6.33008,-9.86133 L 400.5,217.04492 391.75,217.02148 383,217 V 202.34961 Z M 322,188 H 348.5 375 V 253.5 319 H 355 335 V 268 217 H 328.5 322 V 202.5 Z M 195,286 H 211.5 228 V 302.5 319 H 211.5 195 v -16.5 z',
        fillColor: 'red',
		fillOpacity: 0.9,
		strokeWeight: 1,
		rotation: 0,
		scale: 0.08,
	};

	return (
		<>
			{ center.lat || center.lng ? 
            
            <GoogleMap
                className='map__image'
				mapContainerStyle={{width: "88vw", height:"30vh"}}
				zoom={17}
				center={center}
			>
				<MarkerF
					position={center}
					icon={customMarker}
				/>
			</GoogleMap>
            :
            <MapAustAndNz className='map__image'/>
}
		</>
	);
};
